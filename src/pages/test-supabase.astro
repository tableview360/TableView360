---
import { supabase } from '../lib/supabaseClient';

// Verificar variables de entorno
const supabaseUrl = import.meta.env.PUBLIC_SUPABASE_URL;
const supabaseKey = import.meta.env.PUBLIC_SUPABASE_ANON_KEY;

// Intentar obtener datos
let reservations = [];
let error = null;

try {
  const { data, error: fetchError } = await supabase
    .from('reservations')
    .select('*');
  if (fetchError) {
    error = fetchError;
  } else {
    reservations = data;
  }
} catch (e) {
  error = e;
}
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Test Supabase</title>
  </head>
  <body
    style="font-family: monospace; padding: 20px; background: #1e293b; color: #fff;"
  >
    <h1>üîç Test de Conexi√≥n Supabase</h1>

    <h2>Variables de Entorno:</h2>
    <pre
      style="background: #0f172a; padding: 15px; border-radius: 8px; overflow-x: auto;">
URL: {supabaseUrl || '‚ùå NO DEFINIDA'}
Key: {supabaseKey ? '‚úÖ Definida (' + supabaseKey.substring(0, 20) + '...)' : '‚ùå NO DEFINIDA'}
    </pre>

    <h2>Resultado de la Consulta:</h2>
    {
      error ? (
        <div style="background: #7f1d1d; padding: 15px; border-radius: 8px; border: 2px solid #dc2626;">
          <strong>‚ùå Error:</strong>
          <pre>{JSON.stringify(error, null, 2)}</pre>
        </div>
      ) : (
        <div style="background: #064e3b; padding: 15px; border-radius: 8px; border: 2px solid #10b981;">
          <strong>
            ‚úÖ √âxito! Registros encontrados: {reservations.length}
          </strong>
          <pre>{JSON.stringify(reservations, null, 2)}</pre>
        </div>
      )
    }

    <br />
    <a href="/" style="color: #818cf8;">‚Üê Volver al inicio</a>
  </body>
</html>
